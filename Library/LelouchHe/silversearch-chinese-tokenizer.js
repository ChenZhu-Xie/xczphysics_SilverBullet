var U=Object.defineProperty;var v=(e,t)=>{for(var r in t)U(e,r,{get:t[r],enumerable:!0})};var s,f=null;function m(){return(f===null||f.byteLength===0)&&(f=new Uint8Array(s.memory.buffer)),f}var g=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&g.decode();var K=2146435072,b=0;function k(e,t){return b+=t,b>=K&&(g=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},g.decode(),b=t),g.decode(m().subarray(e,e+t))}function w(e,t){return e=e>>>0,k(e,t)}function _(e){let t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){let o=e.description;return o==null?"Symbol":`Symbol(${o})`}if(t=="function"){let o=e.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(e)){let o=e.length,c="[";o>0&&(c+=_(e[0]));for(let a=1;a<o;a++)c+=", "+_(e[a]);return c+="]",c}let r=/\[object ([^\]]+)\]/.exec(toString.call(e)),i;if(r&&r.length>1)i=r[1];else return toString.call(e);if(i=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:i}var x=0,y=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},O=typeof y.encodeInto=="function"?function(e,t){return y.encodeInto(e,t)}:function(e,t){let r=y.encode(e);return t.set(r),{read:e.length,written:r.length}};function C(e,t,r){if(r===void 0){let u=y.encode(e),d=t(u.length,1)>>>0;return m().subarray(d,d+u.length).set(u),x=u.length,d}let i=e.length,o=t(i,1)>>>0,c=m(),a=0;for(;a<i;a++){let u=e.charCodeAt(a);if(u>127)break;c[o+a]=u}if(a!==i){a!==0&&(e=e.slice(a)),o=r(o,i,i=a+e.length*3,1)>>>0;let u=m().subarray(o+a,o+i),d=O(e,u);a+=d.written,o=r(o,i,a,1)>>>0}return x=a,o}var l=null;function h(){return(l===null||l.buffer.detached===!0||l.buffer.detached===void 0&&l.buffer!==s.memory.buffer)&&(l=new DataView(s.memory.buffer)),l}function L(e){return e==null}function R(e,t){e=e>>>0;let r=h(),i=[];for(let o=e;o<e+4*t;o+=4)i.push(s.__wbindgen_export_2.get(r.getUint32(o,!0)));return s.__externref_drop_slice(e,t),i}function S(e,t){let r=C(e,s.__wbindgen_malloc,s.__wbindgen_realloc),i=x,o=s.cut_for_search(r,i,L(t)?16777215:t?1:0),c=R(o[0],o[1]).slice();return s.__wbindgen_free(o[0],o[1]*4,4),c}var j=new Set(["basic","cors","default"]);async function B(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(i){if(e.ok&&j.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}let r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{let r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function I(){let e={};return e.wbg={},e.wbg.__wbg_Error_0497d5bdba9362e5=function(t,r){return Error(w(t,r))},e.wbg.__wbg_new_07b483f72211fd66=function(){return new Object},e.wbg.__wbg_set_3f1d0b984ed272ed=function(t,r,i){t[r]=i},e.wbg.__wbindgen_bigint_from_u64=function(t){return BigInt.asUintN(64,t)},e.wbg.__wbindgen_debug_string=function(t,r){let i=_(r),o=C(i,s.__wbindgen_malloc,s.__wbindgen_realloc),c=x;h().setInt32(t+4*1,c,!0),h().setInt32(t+4*0,o,!0)},e.wbg.__wbindgen_init_externref_table=function(){let t=s.__wbindgen_export_2,r=t.grow(4);t.set(0,void 0),t.set(r+0,void 0),t.set(r+1,null),t.set(r+2,!0),t.set(r+3,!1)},e.wbg.__wbindgen_number_new=function(t){return t},e.wbg.__wbindgen_string_new=function(t,r){return w(t,r)},e.wbg.__wbindgen_throw=function(t,r){throw new Error(w(t,r))},e}function W(e,t){return s=e.exports,A.__wbindgen_wasm_module=t,l=null,f=null,s.__wbindgen_start(),s}async function A(e){if(s!==void 0)return s;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("jieba_rs_wasm_bg.wasm",import.meta.url));let t=I();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));let{instance:r,module:i}=await B(await e,t);return W(r,i)}var T=A;typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});function n(e,...t){return globalThis.syscall(e,...t)}var P={};v(P,{deleteDocument:()=>te,deleteFile:()=>se,deletePage:()=>G,fileExists:()=>ae,getDocumentMeta:()=>X,getFileMeta:()=>oe,getPageMeta:()=>z,listDocuments:()=>J,listFiles:()=>re,listPages:()=>$,listPlugs:()=>Y,pageExists:()=>Q,readDocument:()=>Z,readFile:()=>ne,readPage:()=>N,writeDocument:()=>ee,writeFile:()=>ie,writePage:()=>H});function $(){return n("space.listPages")}function z(e){return n("space.getPageMeta",e)}function Q(e){return n("space.pageExists",e)}function N(e){return n("space.readPage",e)}function H(e,t){return n("space.writePage",e,t)}function G(e){return n("space.deletePage",e)}function Y(){return n("space.listPlugs")}function J(){return n("space.listDocuments")}function X(e){return n("space.getDocumentMeta",e)}function Z(e){return n("space.readDocument",e)}function ee(e,t){return n("space.writeDocument",e,t)}function te(e){return n("space.deleteDocument",e)}function re(){return n("space.listFiles")}function ne(e){return n("space.readFile",e)}function oe(e){return n("space.getFileMeta",e)}function ie(e,t){return n("space.writeFile",e,t)}function se(e){return n("space.deleteFile",e)}function ae(e){return n("space.fileExists",e)}var p={};v(p,{del:()=>de,get:()=>le,set:()=>ue});function ue(e,t){return n("clientStore.set",e,t)}function le(e){return n("clientStore.get",e)}function de(e){return n("clientStore.delete",e)}var Re=new Uint8Array(16);var Se="Library/LelouchHe",F=`${Se}/silversearch-chinese-tokenizer.wasm`,M="silversearch-chinese-tokenizer",E=1,D=null;async function rt(){if(D){console.log("[Silversearch-Chinese-Tokenizer] Already initialized");return}let e=await p.get(M);(!e||e.version!==E)&&(console.log(`[Silversearch-Chinese-Tokenizer] Not found in cache, loading from ${F}`),e={version:E,data:await P.readFile(F)},await p.set(M,e),console.log(`[Silversearch-Chinese-Tokenizer] Loaded, size: ${Math.floor(e.data.length/1024)} KB`));try{D=await T({module_or_path:e.data}),console.log("[Silversearch-Chinese-Tokenizer] Initialized")}catch(t){console.error("[Silversearch-Chinese-Tokenizer] Failed to load: ",t);return}}function nt(e){return/[\u4e00-\u9fff]/u.test(e)}function ot(e){return S(e,!0).filter(t=>!/^[\p{P}\s]+$/u.test(t))}export{rt as init,nt as isTokenizable,ot as tokenize};
