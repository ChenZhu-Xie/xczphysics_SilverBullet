var D=Object.defineProperty;var v=(e,t)=>{for(var r in t)D(e,r,{get:t[r],enumerable:!0})};var s,f=null;function m(){return(f===null||f.byteLength===0)&&(f=new Uint8Array(s.memory.buffer)),f}var g=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&g.decode();var K=2146435072,b=0;function R(e,t){return b+=t,b>=K&&(g=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},g.decode(),b=t),g.decode(m().subarray(e,e+t))}function w(e,t){return e=e>>>0,R(e,t)}function _(e){let t=typeof e;if(t=="number"||t=="boolean"||e==null)return`${e}`;if(t=="string")return`"${e}"`;if(t=="symbol"){let i=e.description;return i==null?"Symbol":`Symbol(${i})`}if(t=="function"){let i=e.name;return typeof i=="string"&&i.length>0?`Function(${i})`:"Function"}if(Array.isArray(e)){let i=e.length,u="[";i>0&&(u+=_(e[0]));for(let a=1;a<i;a++)u+=", "+_(e[a]);return u+="]",u}let r=/\[object ([^\]]+)\]/.exec(toString.call(e)),o;if(r&&r.length>1)o=r[1];else return toString.call(e);if(o=="Object")try{return"Object("+JSON.stringify(e)+")"}catch{return"Object"}return e instanceof Error?`${e.name}: ${e.message}
${e.stack}`:o}var x=0,y=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},k=typeof y.encodeInto=="function"?function(e,t){return y.encodeInto(e,t)}:function(e,t){let r=y.encode(e);return t.set(r),{read:e.length,written:r.length}};function A(e,t,r){if(r===void 0){let c=y.encode(e),d=t(c.length,1)>>>0;return m().subarray(d,d+c.length).set(c),x=c.length,d}let o=e.length,i=t(o,1)>>>0,u=m(),a=0;for(;a<o;a++){let c=e.charCodeAt(a);if(c>127)break;u[i+a]=c}if(a!==o){a!==0&&(e=e.slice(a)),i=r(i,o,o=a+e.length*3,1)>>>0;let c=m().subarray(i+a,i+o),d=k(e,c);a+=d.written,i=r(i,o,a,1)>>>0}return x=a,i}var l=null;function h(){return(l===null||l.buffer.detached===!0||l.buffer.detached===void 0&&l.buffer!==s.memory.buffer)&&(l=new DataView(s.memory.buffer)),l}function O(e,t){e=e>>>0;let r=h(),o=[];for(let i=e;i<e+4*t;i+=4)o.push(s.__wbindgen_export_2.get(r.getUint32(i,!0)));return s.__externref_drop_slice(e,t),o}function C(e){let t=A(e,s.__wbindgen_malloc,s.__wbindgen_realloc),r=x,o=s.cut_all(t,r),i=O(o[0],o[1]).slice();return s.__wbindgen_free(o[0],o[1]*4,4),i}var L=new Set(["basic","cors","default"]);async function B(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(o){if(e.ok&&L.has(e.type)&&e.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}let r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{let r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function j(){let e={};return e.wbg={},e.wbg.__wbg_Error_0497d5bdba9362e5=function(t,r){return Error(w(t,r))},e.wbg.__wbg_new_07b483f72211fd66=function(){return new Object},e.wbg.__wbg_set_3f1d0b984ed272ed=function(t,r,o){t[r]=o},e.wbg.__wbindgen_bigint_from_u64=function(t){return BigInt.asUintN(64,t)},e.wbg.__wbindgen_debug_string=function(t,r){let o=_(r),i=A(o,s.__wbindgen_malloc,s.__wbindgen_realloc),u=x;h().setInt32(t+4*1,u,!0),h().setInt32(t+4*0,i,!0)},e.wbg.__wbindgen_init_externref_table=function(){let t=s.__wbindgen_export_2,r=t.grow(4);t.set(0,void 0),t.set(r+0,void 0),t.set(r+1,null),t.set(r+2,!0),t.set(r+3,!1)},e.wbg.__wbindgen_number_new=function(t){return t},e.wbg.__wbindgen_string_new=function(t,r){return w(t,r)},e.wbg.__wbindgen_throw=function(t,r){throw new Error(w(t,r))},e}function W(e,t){return s=e.exports,S.__wbindgen_wasm_module=t,l=null,f=null,s.__wbindgen_start(),s}async function S(e){if(s!==void 0)return s;typeof e<"u"&&(Object.getPrototypeOf(e)===Object.prototype?{module_or_path:e}=e:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof e>"u"&&(e=new URL("jieba_rs_wasm_bg.wasm",import.meta.url));let t=j();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));let{instance:r,module:o}=await B(await e,t);return W(r,o)}var F=S;typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});function n(e,...t){return globalThis.syscall(e,...t)}var P={};v(P,{deleteDocument:()=>te,deleteFile:()=>ce,deletePage:()=>G,fileExists:()=>ue,getDocumentMeta:()=>X,getFileMeta:()=>se,getPageMeta:()=>$,listDocuments:()=>J,listFiles:()=>re,listPages:()=>V,listPlugs:()=>Y,pageExists:()=>Q,readDocument:()=>Z,readFile:()=>ne,readFileWithMeta:()=>ie,readPage:()=>z,readPageWithMeta:()=>N,readRef:()=>oe,writeDocument:()=>ee,writeFile:()=>ae,writePage:()=>H});function V(){return n("space.listPages")}function $(e){return n("space.getPageMeta",e)}function Q(e){return n("space.pageExists",e)}function z(e){return n("space.readPage",e)}function N(e){return n("space.readPageWithMeta",e)}function H(e,t){return n("space.writePage",e,t)}function G(e){return n("space.deletePage",e)}function Y(){return n("space.listPlugs")}function J(){return n("space.listDocuments")}function X(e){return n("space.getDocumentMeta",e)}function Z(e){return n("space.readDocument",e)}function ee(e,t){return n("space.writeDocument",e,t)}function te(e){return n("space.deleteDocument",e)}function re(){return n("space.listFiles")}function ne(e){return n("space.readFile",e)}function oe(e){return n("space.readRef",e)}function ie(e){return n("space.readFileWithMeta",e)}function se(e){return n("space.getFileMeta",e)}function ae(e,t){return n("space.writeFile",e,t)}function ce(e){return n("space.deleteFile",e)}function ue(e){return n("space.fileExists",e)}var p={};v(p,{del:()=>pe,get:()=>fe,set:()=>de});function de(e,t){return n("clientStore.set",e,t)}function fe(e){return n("clientStore.get",e)}function pe(e){return n("clientStore.delete",e)}var Be=new Uint8Array(16);var Se="Library/Al3cLee",T=`${Se}/silversearch-chinese-tokenizer.wasm`,M="silversearch-chinese-tokenizer",E=1,U=null;async function nt(){if(U){console.log("[Silversearch-Chinese-Tokenizer] Already initialized");return}let e=await p.get(M);(!e||e.version!==E)&&(console.log(`[Silversearch-Chinese-Tokenizer] Not found in cache, loading from ${T}`),e={version:E,data:await P.readFile(T)},await p.set(M,e),console.log(`[Silversearch-Chinese-Tokenizer] Loaded, size: ${Math.floor(e.data.length/1024)} KB`));try{U=await F({module_or_path:e.data}),console.log("[Silversearch-Chinese-Tokenizer] Initialized")}catch(t){console.error("[Silversearch-Chinese-Tokenizer] Failed to load: ",t);return}}function ot(e){return/[\u4e00-\u9fff]/u.test(e)}function it(e){return C(e,!0).filter(t=>!/^[\p{P}\s]+$/u.test(t))}export{nt as init,ot as isTokenizable,it as tokenize};
