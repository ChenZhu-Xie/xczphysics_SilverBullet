
# Global Search

## add `and` logic Ver 3

```space-lua
-- ============================================
-- Configuration
-- ============================================
local config = {
    showParentHeaders = true,
    contextLength = 15
}

-- Highlight styles for different keywords (å¾ªçŽ¯ä½¿ç”¨)
local highlightStyles = {
    function(kw) return "==" .. kw .. "==" end,           -- é»„è‰²é«˜äº®
    function(kw) return "**" .. kw .. "**" end,           -- ç²—ä½“
    function(kw) return "*" .. kw .. "*" end,             -- æ–œä½“
    function(kw) return "**==" .. kw .. "==**" end,       -- ç²—ä½“+é«˜äº®
    function(kw) return "*==" .. kw .. "==*" end,         -- æ–œä½“+é«˜äº®
    function(kw) return "`" .. kw .. "`" end,             -- ä»£ç 
    function(kw) return "**`" .. kw .. "`**" end,         -- ç²—ä½“+ä»£ç 
    function(kw) return "*`" .. kw .. "`*" end,           -- æ–œä½“+ä»£ç 
}

-- Clean context string (remove newlines, truncate)
local function cleanContext(s, maxLen)
    if not s then return "" end
    local cleaned = string.gsub(s, "[\r\n]+", " ")
    if maxLen and #cleaned > maxLen then
        cleaned = string.sub(cleaned, 1, maxLen) .. "â€¦"
    end
    return cleaned
end

-- Generate heading prefix based on depth
local function headingPrefix(depth)
    if depth > 6 then depth = 6 end
    return string.rep("#", depth) .. " "
end

-- Build hierarchical headers for a page path
local function buildHierarchicalHeaders(pageName, existingPaths)
    local output = {}
    local parts = {}
    for part in string.gmatch(pageName, "[^/]+") do
        table.insert(parts, part)
    end
    
    local currentPath = ""
    for i, part in ipairs(parts) do
        if i > 1 then
            currentPath = currentPath .. "/"
        end
        currentPath = currentPath .. part
        
        if not existingPaths[currentPath] then
            existingPaths[currentPath] = true
            if i == #parts then
                table.insert(output, headingPrefix(i) .. "[[" .. pageName .. "]]")
            elseif config.showParentHeaders then
                table.insert(output, headingPrefix(i) .. part)
            end
        end
    end
    
    return output
end

-- Parse keywords from input (split by space, support AND logic)
local function parseKeywords(input)
    local keywords = {}
    for kw in string.gmatch(input, "[^%s]+") do
        if kw ~= "" then
            table.insert(keywords, kw)
        end
    end
    return keywords
end

-- Check if content contains ALL keywords (AND logic)
local function containsAllKeywords(content, keywords)
    for _, kw in ipairs(keywords) do
        if not string.find(content, kw, 1, true) then
            return false
        end
    end
    return true
end

-- Find the range that covers all keyword occurrences closest to each other
local function findBestMatchRange(content, keywords, ctxLen)
    local contentLen = #content
    local matches = {}
    
    -- Find first occurrence of each keyword
    for i, kw in ipairs(keywords) do
        local pos = string.find(content, kw, 1, true)
        if pos then
            table.insert(matches, {
                keyword = kw,
                keywordIndex = i,
                pos = pos,
                endPos = pos + #kw - 1
            })
        end
    end
    
    if #matches ~= #keywords then
        return nil
    end
    
    -- Sort by position
    table.sort(matches, function(a, b) return a.pos < b.pos end)
    
    -- Calculate range
    local firstPos = matches[1].pos
    local lastEndPos = matches[#matches].endPos
    
    local prefixStart = math.max(1, firstPos - ctxLen)
    local suffixEnd = math.min(contentLen, lastEndPos + ctxLen)
    
    return {
        prefixStart = prefixStart,
        firstPos = firstPos,
        lastEndPos = lastEndPos,
        suffixEnd = suffixEnd,
        matches = matches
    }
end

-- Extract all match contexts from content
local function findAllMatchContexts(content, keywords)
    local contexts = {}
    local ctxLen = config.contextLength
    local contentLen = #content
    local searchStart = 1
    local maxIterations = 100
    local iteration = 0
    
    while iteration < maxIterations do
        iteration = iteration + 1
        
        -- Find positions of all keywords starting from searchStart
        local positions = {}
        local allFound = true
        
        for i, kw in ipairs(keywords) do
            local pos = string.find(content, kw, searchStart, true)
            if not pos then
                allFound = false
                break
            end
            table.insert(positions, {
                keyword = kw,
                keywordIndex = i,
                pos = pos,
                len = #kw
            })
        end
        
        if not allFound then
            break
        end
        
        -- Sort by position
        table.sort(positions, function(a, b) return a.pos < b.pos end)
        
        -- Build context with all keywords highlighted
        local firstPos = positions[1].pos
        local lastPos = positions[#positions].pos + positions[#positions].len - 1
        
        local prefixStart = math.max(1, firstPos - ctxLen)
        local suffixEnd = math.min(contentLen, lastPos + ctxLen)
        
        -- Extract the full snippet
        local snippet = string.sub(content, prefixStart, suffixEnd)
        
        -- Apply highlights to the snippet (in reverse order to preserve positions)
        local adjustedPositions = {}
        for _, p in ipairs(positions) do
            table.insert(adjustedPositions, {
                keyword = p.keyword,
                keywordIndex = p.keywordIndex,
                relPos = p.pos - prefixStart + 1,
                len = p.len
            })
        end
        
        -- Sort by position descending for safe replacement
        table.sort(adjustedPositions, function(a, b) return a.relPos > b.relPos end)
        
        for _, p in ipairs(adjustedPositions) do
            local styleIndex = ((p.keywordIndex - 1) % #highlightStyles) + 1
            local highlightFn = highlightStyles[styleIndex]
            local before = string.sub(snippet, 1, p.relPos - 1)
            local after = string.sub(snippet, p.relPos + p.len)
            snippet = before .. highlightFn(p.keyword) .. after
        end
        
        table.insert(contexts, {
            snippet = snippet,
            startPos = prefixStart
        })
        
        -- Move search start past the first keyword
        searchStart = positions[1].pos + 1
    end
    
    return contexts
end

-- Core search function with AND logic
local function searchGlobalOptimized(keywordInput)
    if not keywordInput or keywordInput == "" then
        return nil, 0, 0, {}
    end
    
    local keywords = parseKeywords(keywordInput)
    if #keywords == 0 then
        return nil, 0, 0, {}
    end
    
    local results = {}
    local matchCount = 0
    local pageCount = 0
    
    local pages = space.listPages()
    local existingPaths = {}
    
    for _, page in ipairs(pages) do
        if not string.find(page.name, "^search:") then
            local content = space.readPage(page.name)
            
            if content and containsAllKeywords(content, keywords) then
                local contexts = findAllMatchContexts(content, keywords)
                
                if #contexts > 0 then
                    pageCount = pageCount + 1
                    local headers = buildHierarchicalHeaders(page.name, existingPaths)
                    for _, header in ipairs(headers) do
                        table.insert(results, header)
                    end
                    
                    for i, ctx in ipairs(contexts) do
                        local formatted = string.format("%d. â€¦%sâ€¦", i, ctx.snippet)
                        table.insert(results, formatted)
                        matchCount = matchCount + 1
                    end
                    table.insert(results, "")
                end
            end
        end
    end
    
    return results, matchCount, pageCount, keywords
end

-- Build keyword legend for header
local function buildKeywordLegend(keywords)
    local parts = {}
    for i, kw in ipairs(keywords) do
        local styleIndex = ((i - 1) % #highlightStyles) + 1
        local highlightFn = highlightStyles[styleIndex]
        table.insert(parts, highlightFn(kw))
    end
    return table.concat(parts, " AND ")
end

-- Virtual Page: search:keyword1 keyword2 ...
virtualPage.define {
    pattern = "search:(.+)",
    run = function(keywordInput)
        keywordInput = keywordInput:trim()
        
        if not keywordInput or keywordInput == "" then
            return [[
# âš ï¸ Search Error
Please provide search keywords.
**Usage:** Navigate to `search:keyword1 keyword2` or use command `Global Search`
- Multiple keywords separated by space = AND logic
]]
        end
        
        local results, matchCount, pageCount, keywords = searchGlobalOptimized(keywordInput)
        local output = {}
        
        table.insert(output, "# ðŸ” Search Results")
        
        local legend = buildKeywordLegend(keywords)
        table.insert(output, string.format(
            "> **Keywords:** %s | **Matches:** %d | **Pages:** %d",
            legend, matchCount, pageCount
        ))
        
        if matchCount == 0 then
            table.insert(output, "")
            table.insert(output, "ðŸ˜” **No results found**")
            table.insert(output, "")
            table.insert(output, "Suggestions:")
            table.insert(output, "1. Check spelling")
            table.insert(output, "2. Try fewer keywords")
            table.insert(output, "3. Keywords are case-sensitive")
            table.insert(output, "4. All keywords must appear in the same page (AND logic)")
        else
            table.insert(output, "")
            for _, line in ipairs(results) do
                table.insert(output, line)
            end
        end
        
        return table.concat(output, "\n")
    end
}

-- Command: Global Search
command.define {
    name = "Global Search",
    run = function()
        local keyword = editor.prompt("ðŸ” Global Search (space = AND)", "")
        if keyword and keyword:trim() ~= "" then
            editor.navigate("search:" .. keyword:trim())
        end
    end,
    key = "Ctrl-Shift-f",
    mac = "Cmd-Shift-f",
    priority = 1,
}
```

## Virtual Page Ver 2

```lua
-- ============================================
-- Configuration
-- ============================================
local config = {
    showParentHeaders = false,
    contextLength = 15
}

-- Escape Lua pattern special characters
local function escapeLuaPattern(s)
    return (s:gsub("([%%%.%[%]%*%+%-%?%^%$%(%)%{%}])", "%%%1"))
end

-- Clean context string (remove newlines, truncate)
local function cleanContext(s, maxLen)
    if not s then return "" end
    local cleaned = string.gsub(s, "[\r\n]+", " ")
    if maxLen and #cleaned > maxLen then
        cleaned = string.sub(cleaned, 1, maxLen) .. "â€¦"
    end
    return cleaned
end

-- Generate heading prefix based on depth
local function headingPrefix(depth)
    if depth > 6 then depth = 6 end
    return string.rep("#", depth) .. " "
end

-- Build hierarchical headers for a page path
local function buildHierarchicalHeaders(pageName, existingPaths)
    local output = {}
    local parts = {}
    for part in string.gmatch(pageName, "[^/]+") do
        table.insert(parts, part)
    end
    
    local currentPath = ""
    for i, part in ipairs(parts) do
        if i > 1 then
            currentPath = currentPath .. "/"
        end
        currentPath = currentPath .. part
        
        if not existingPaths[currentPath] then
            existingPaths[currentPath] = true
            if i == #parts then
                table.insert(output, headingPrefix(i) .. "[[" .. pageName .. "]]")
            elseif config.showParentHeaders then
                table.insert(output, headingPrefix(i) .. part)
            end
        end
    end
    
    return output
end

-- Extract all matches with context using plain string operations
local function findAllMatches(content, keyword)
    local matches = {}
    local startPos = 1
    local keywordLen = #keyword
    local contentLen = #content
    local ctxLen = config.contextLength
    
    while true do
        local foundPos = string.find(content, keyword, startPos, true)
        if not foundPos then break end
        
        local prefixStart = math.max(1, foundPos - ctxLen)
        local suffixEnd = math.min(contentLen, foundPos + keywordLen - 1 + ctxLen)
        
        local prefix = string.sub(content, prefixStart, foundPos - 1)
        local suffix = string.sub(content, foundPos + keywordLen, suffixEnd)
        
        table.insert(matches, {
            prefix = cleanContext(prefix, ctxLen),
            suffix = cleanContext(suffix, ctxLen)
        })
        
        startPos = foundPos + 1
    end
    
    return matches
end

-- Core search function
local function searchGlobalOptimized(keyword)
    if not keyword or keyword == "" then
        return nil, 0, 0
    end
    
    local results = {}
    local matchCount = 0
    local pageCount = 0
    
    local pages = space.listPages()
    local existingPaths = {}
    
    for _, page in ipairs(pages) do
        if not string.find(page.name, "^search:") then
            local content = space.readPage(page.name)
            
            if content and string.find(content, keyword, 1, true) then
                local allMatches = findAllMatches(content, keyword)
                
                if #allMatches > 0 then
                    pageCount = pageCount + 1
                    local headers = buildHierarchicalHeaders(page.name, existingPaths)
                    for _, header in ipairs(headers) do
                        table.insert(results, header)
                    end
                    
                    for i, match in ipairs(allMatches) do
                        local formatted = string.format(
                            "%d. â€¦%s==%s==%sâ€¦",
                            i,
                            match.prefix,
                            keyword,
                            match.suffix
                        )
                        table.insert(results, formatted)
                        matchCount = matchCount + 1
                    end
                    table.insert(results, "")
                end
            end
        end
    end
    
    return results, matchCount, pageCount
end

-- Virtual Page: search:keyword
virtualPage.define {
    pattern = "search:(.+)",
    run = function(keyword)
        keyword = keyword:trim()
        
        if not keyword or keyword == "" then
            return [[
# âš ï¸ Search Error
Please provide a search keyword.
**Usage:** Navigate to `search:your_keyword` or use command `Global Search`
]]
        end
        
        local results, matchCount, pageCount = searchGlobalOptimized(keyword)
        local output = {}
        
        table.insert(output, "# ðŸ” Search Results")
        table.insert(output, string.format(
            "> **Keyword:** ==`%s`== | **Matches:** %d | **Pages:** %d",
            keyword, matchCount, pageCount
        ))
        
        if matchCount == 0 then
            table.insert(output, "")
            table.insert(output, "ðŸ˜” **No results found**")
            table.insert(output, "")
            table.insert(output, "Suggestions:")
            table.insert(output, "1. Check spelling")
            table.insert(output, "2. Try shorter or more general keywords")
            table.insert(output, "3. Keywords are case-sensitive")
        else
            table.insert(output, "")
            for _, line in ipairs(results) do
                table.insert(output, line)
            end
        end
        
        return table.concat(output, "\n")
    end
}

-- Command: Global Search
command.define {
    name = "Global Search",
    run = function()
        local keyword = editor.prompt("ðŸ” Global Search", "")
        if keyword and keyword:trim() ~= "" then
            editor.navigate("search:" .. keyword:trim())
        end
    end,
    key = "Ctrl-Shift-f",
    mac = "Cmd-Shift-f",
    priority = 1,
}
```

## Virtual Page Ver 1

```lua
-- priority: 11

-- ============================================
-- å·¥å…·å‡½æ•°ï¼šè½¬ä¹‰ Lua æ­£åˆ™ç‰¹æ®Šå­—ç¬¦
-- ============================================
-- Escape Lua pattern special characters
local function escapeLuaPattern(s)
    local matches = {
        ["^"] = "%^", ["$"] = "%$", ["("] = "%(", [")"] = "%)",
        ["%"] = "%%", ["."] = "%." , ["["] = "%[", ["]"] = "%]",
        ["*"] = "%*", ["+"] = "%+", ["-"] = "%-", ["?"] = "%?"
    }
    return string.gsub(s, ".", matches)
end

-- ============================================
-- å·¥å…·å‡½æ•°ï¼šæ¸…ç†å­—ç¬¦ä¸²ï¼ˆåŽ»é™¤é¦–å°¾ç©ºç™½ã€æ›¿æ¢æ¢è¡Œç¬¦ï¼‰
-- ============================================
local function cleanContext(s, maxLen)
    if not s then return "" end
    -- æ›¿æ¢æ¢è¡Œä¸ºç©ºæ ¼ï¼Œé¿å…ç ´ååˆ—è¡¨æ ¼å¼
    local cleaned = string.gsub(s, "[\r\n]+", " ")
    -- æˆªæ–­è¿‡é•¿å†…å®¹
    if maxLen and #cleaned > maxLen then
        cleaned = string.sub(cleaned, 1, maxLen) .. "â€¦"
    end
    return cleaned
end

-- ============================================
-- æ ¸å¿ƒæœç´¢å‡½æ•°ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
-- ============================================
local function searchGlobalOptimized(keyword)
    if not keyword or keyword == "" then
        return nil, 0
    end
    
    local output = {}
    local matchCount = 0
    local pageCount = 0
    
    -- é¢„ç¼–è¯‘ patternï¼ˆLua å®žé™…ä¸Šæ¯æ¬¡ gmatch éƒ½ç¼–è¯‘ï¼Œä½†è¿™é‡Œç»Ÿä¸€å®šä¹‰ï¼‰
    local escapedKeyword = escapeLuaPattern(keyword)
    -- æ•èŽ· keyword å‰åŽå„ 15 ä¸ªå­—ç¬¦ä½œä¸ºä¸Šä¸‹æ–‡
    local pattern = "(.{0,15})" .. escapedKeyword .. "(.{0,15})"
    
    local pages = space.listPages()
    
    for _, page in ipairs(pages) do
        -- è·³è¿‡æœç´¢ç»“æžœé¡µæœ¬èº«ï¼Œé˜²æ­¢æ­»å¾ªçŽ¯
        if not string.find(page.name, "^search:") then
            local content = space.readPage(page.name)
            
            if content then
                -- [æ ¸å¿ƒä¼˜åŒ–] å…ˆç”¨ plain string search å¿«é€Ÿæ£€æŸ¥
                -- string.find çš„ç¬¬4ä¸ªå‚æ•° true è¡¨ç¤ºçº¯æ–‡æœ¬åŒ¹é…ï¼Œä¸è§£é‡Š pattern
                if string.find(content, keyword, 1, true) then
                    local pageMatches = {}
                    
                    -- åªæœ‰ç¡®è®¤åŒ…å«å…³é”®è¯åŽï¼Œæ‰æ‰§è¡Œæ˜‚è´µçš„æ­£åˆ™æå–
                    for prefix, suffix in string.gmatch(content, pattern) do
                        local cleanPrefix = cleanContext(prefix, 15)
                        local cleanSuffix = cleanContext(suffix, 15)
                        
                        -- ä½¿ç”¨ SilverBullet çš„é«˜äº®è¯­æ³• ==keyword==
                        local formatted = string.format(
                            "* â€¦%s==%s==%sâ€¦",
                            cleanPrefix,
                            keyword,
                            cleanSuffix
                        )
                        table.insert(pageMatches, formatted)
                        matchCount = matchCount + 1
                    end
                    
                    -- åªæœ‰æœ‰åŒ¹é…æ—¶æ‰è¾“å‡ºè¯¥é¡µé¢
                    if #pageMatches > 0 then
                        pageCount = pageCount + 1
                        -- é¡µé¢æ ‡é¢˜ï¼ˆå¯ç‚¹å‡»çš„ wiki linkï¼‰
                        table.insert(output, "### [[" .. page.name .. "]]")
                        -- è¯¥é¡µé¢çš„æ‰€æœ‰åŒ¹é…é¡¹
                        for _, match in ipairs(pageMatches) do
                            table.insert(output, match)
                        end
                        -- é¡µé¢ä¹‹é—´çš„ç©ºè¡Œåˆ†éš”
                        table.insert(output, "")
                    end
                end
            end
        end
    end
    
    return output, matchCount, pageCount
end

-- ============================================
-- å®šä¹‰ Virtual Pageï¼šsearch:å…³é”®è¯
-- ============================================
virtualPage.define {
    pattern = "search:(.+)",
    run = function(keyword)
        -- æ¸…ç†å…³é”®è¯
        keyword = keyword:trim()
        
        if not keyword or keyword == "" then
            return [[
# âš ï¸ æœç´¢é”™è¯¯

è¯·æä¾›æœç´¢å…³é”®è¯ã€‚

**ç”¨æ³•ï¼š** å¯¼èˆªåˆ° `search:ä½ çš„å…³é”®è¯` æˆ–ä½¿ç”¨å‘½ä»¤ `Global Search`
]]
        end
        
        -- æ‰§è¡Œæœç´¢
        local results, matchCount, pageCount = searchGlobalOptimized(keyword)
        
        -- æž„å»ºè¾“å‡º
        local output = {}
        
        -- å¤´éƒ¨ä¿¡æ¯
        table.insert(output, "# ðŸ” æœç´¢ç»“æžœ")
        table.insert(output, "")
        table.insert(output, string.format(
            "> **å…³é”®è¯ï¼š** `%s` | **åŒ¹é…ï¼š** %d å¤„ | **é¡µé¢ï¼š** %d ä¸ª",
            keyword, matchCount, pageCount
        ))
        table.insert(output, "")
        
        if matchCount == 0 then
            table.insert(output, "---")
            table.insert(output, "")
            table.insert(output, "ðŸ˜” **æœªæ‰¾åˆ°åŒ¹é…ç»“æžœ**")
            table.insert(output, "")
            table.insert(output, "å»ºè®®ï¼š")
            table.insert(output, "* æ£€æŸ¥æ‹¼å†™æ˜¯å¦æ­£ç¡®")
            table.insert(output, "* å°è¯•ä½¿ç”¨æ›´çŸ­æˆ–æ›´é€šç”¨çš„å…³é”®è¯")
            table.insert(output, "* å…³é”®è¯åŒºåˆ†å¤§å°å†™")
        else
            table.insert(output, "---")
            table.insert(output, "")
            -- åˆå¹¶æœç´¢ç»“æžœ
            for _, line in ipairs(results) do
                table.insert(output, line)
            end
        end
        
        -- ä½¿ç”¨ table.concat é«˜æ•ˆæ‹¼æŽ¥ï¼ˆæ¯” .. è¿žæŽ¥é«˜æ•ˆå¾—å¤šï¼‰
        return table.concat(output, "\n\n")
    end
}

-- ============================================
-- å®šä¹‰å‘½ä»¤ï¼šå”¤èµ·å…¨å±€æœç´¢
-- ============================================
command.define {
    name = "Global Search",
    run = function()
        local keyword = editor.prompt("ðŸ” å…¨å±€æœç´¢", "è¾“å…¥å…³é”®è¯...")
        if keyword and keyword:trim() ~= "" then
            -- ç›´æŽ¥å¯¼èˆªåˆ° virtual pageï¼Œç”± SilverBullet åŽŸç”Ÿæ¸²æŸ“
            editor.navigate("search:" .. keyword:trim())
        end
    end,
    key = "Ctrl-Alt-f",
    mac = "Cmd-Alt-f",
    priority = 1,
}

command.define {
    name = "Close Search Panel",
    run = function()
        editor.hidePanel('rhs')
    end
}
```

## Old Ver

1. https://community.silverbullet.md/t/fixing-silver-bullets-chinese-search-gap-a-space-lua-global-search-implementation/3157

```lua
-- Escape regular expression special characters in keywords
local function escapeKeyword(keyword)
    -- List of regular expression special characters: . ^ $ * + ? ( ) [ ] { } | \
    local specialChars = {
        ["."] = "%.",
        ["^"] = "%^",
        ["$"] = "%$",
        ["*"] = "%*",
        ["+"] = "%+",
        ["?"] = "%?",
        ["("] = "%(",
        [")"] = "%)",
        ["["] = "%[",
        ["]"] = "%]",
        ["{"] = "%{",
        ["}"] = "%}",
        ["|"] = "%|",
        ["\\"] = "\\\\"
    }
    -- Replace special characters in the keyword with their escaped versions
    return string.gsub(keyword, ".", function(char)
        return specialChars[char] or char
    end)
end

-- Extract 10 characters before and after the keyword (handles cases with fewer than 10 characters)
-- Parameters: content (content to search), keyword (keyword to search for)
-- Returns: Iterator (each iteration returns a match result in the format: prefix + keyword + suffix)
local function extractKeywordContext(content, keyword)
    -- 1. Escape the keyword (handle special characters)
    local escapedKeyword = escapeKeyword(keyword)
    -- 2. Build regular expression pattern (0-10 characters before + keyword + 0-10 characters after)
    local pattern = ".{0,10}" .. escapedKeyword .. ".{0,10}"
    -- 3. Use string.gmatch to iterate through matches and concatenate results
    return string.gmatch(content, pattern)
end

local function searchGlobal(keyword)
    local result = ""
    local pages = space.listPages()
    for i, page in ipairs(pages) do
        local matchs = ""
        local content = space.readPage(page.name)
        for match in extractKeywordContext(content, keyword) do
            matchs = matchs .. "* " .. match .. '\n'
        end
        if #matchs > 0 then
            result = result .. "## [[" .. page.name .. "]]\n" .. matchs
        end
    end
    return result
end

command.define {
  name = "Global Search",
  run = function()
    -- local keyword = editor.prompt("Keyword","")
    local keyword = usrPrompt(Keyword, "")
    if keyword and #keyword > 0 then
      local res = searchGlobal(keyword)
      if #res > 0 then
        editor.showPanel('rhs', 1, markdown.markdownToHtml(res))
      else
        editor.flashNotification('not found', 'warn')
      end
    end
  end,
  key = "Ctrl-Alt-f",
  mac = "Cmd-Alt-f",
  priority = 1,
}

command.define {
  name = "close Global Search",
  run = function()
    editor.hidePanel('rhs')
  end
}
```
